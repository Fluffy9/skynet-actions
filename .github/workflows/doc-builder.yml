name: "Documentation Builder"
on: workflow_dispatch

jobs:
  retrieve: 
    name: Retrieve
    runs-on: "ubuntu-latest"
    steps: 
      - name: Retrieve Skyd Docs
        run: git clone https://gitlab.com/SkynetLabs/skyd/
      - name: Retrieve Skynet Docs
        run: git clone https://github.com/SkynetLabs/skynet-docs/
      - name: Install Whiteboard Tool
        run: git clone https://github.com/mpociot/whiteboard.git
      - name: Merge
        run: |
          rm -r ./whiteboard/source/*
          mv ./skyd/doc ./whiteboard/source
          mv ./skynet-docs/source ./whiteboard/source 
      - uses: actions/setup-node@v2
        with:
          node-version: '14'
      - name: Node Slate Builder
        working-directory: ./whiteboard/source
        run: |
          npm install
          npm run-script generate
      - name: Deploy to Skynet
        uses: SkynetLabs/deploy-to-skynet-action@v2
        with:
          upload-dir: ./whiteboard/public
          github-token: ${{ secrets.GITHUB_TOKEN }}
          registry-seed: ${{ secrets.REGISTRY_SEED || '' }}
          registry-datakey: ${{ secrets.REGISTRY_DATAKEY || '' }}



